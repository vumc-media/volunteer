<!doctype html>
<html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>Get Involved — VUMC</title></head>
<body style="font-family:Arial,Helvetica,sans-serif;max-width:720px;margin:24px auto;padding:0 12px">
  <h1>Get Involved</h1>

  <!-- SUCCESS / ERROR MESSAGES -->
  <div id="ok"  style="display:none;background:#e9f6ec;color:#1b6b2c;padding:10px;border-radius:8px;margin:10px 0">Thanks! Your form was submitted.</div>
  <div id="err" style="display:none;background:#fdebec;color:#9a1c28;padding:10px;border-radius:8px;margin:10px 0">Sorry, something went wrong.</div>

  <!-- Plain HTML form posts directly to your Apps Script endpoint -->
  <form id="serveForm" method="POST" action="https://script.google.com/macros/s/AKfycbyFAuFvAOFDfx10KZKHO0suTmMhfloqUF-MbjjZelO-CtJHR4pNa5Is5fQuIxa4ddJc7A/exec">
    <p><label>First name*<br><input required name="firstName"></label></p>
    <p><label>Last name*<br><input required name="lastName"></label></p>
    <p><label>Email*<br><input required type="email" name="email"></label></p>
    <p><label>Phone<br><input name="phone"></label></p>
    <p><label>Phone type<br>
      <select name="phoneType"><option value="">-- Select --</option><option>Mobile</option><option>Home</option><option>Work</option></select>
    </label></p>
    <p><label>Gifts / Strengths<br><textarea name="gifts" rows="4"></textarea></label></p>

    <fieldset style="border:1px solid #ddd;padding:10px"><legend>Areas of interest</legend>
      <label><input type="checkbox" name="areas" value="3rd Monday Community Meal"> 3rd Monday Community Meal</label><br>
      <label><input type="checkbox" name="areas" value="Backpack Lunch Ministry"> Backpack Lunch Ministry</label><br>
      <label><input type="checkbox" name="areas" value="Blessing Box"> Blessing Box</label><br>
      <label><input type="checkbox" name="areas" value="Diaper Bank Ministry"> Diaper Bank Ministry</label><br>
      <label><input type="checkbox" name="areas" value="Jail Ministry"> Jail Ministry</label><br>
      <label><input type="checkbox" name="areas" value="Kid's ministry"> Kid's ministry</label><br>
      <label><input type="checkbox" name="areas" value="Youth ministry"> Youth ministry</label><br>
      <label><input type="checkbox" name="areas" value="Communication"> Communication</label><br>
      <label><input type="checkbox" name="areas" value="Worship"> Worship</label><br>
      <label><input type="checkbox" name="areas" value="Tech"> Tech</label>
    </fieldset>

    <p><button type="submit">Submit</button></p>
    <p style="color:#666;font-size:12px">We’ll never share your information without your consent.</p>
  </form>

  <!-- Tiny enhancement: show success/error without leaving the page -->
  <script>
    const form = document.getElementById('serveForm');
    const ok   = document.getElementById('ok');
    const err  = document.getElementById('err');

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      ok.style.display = 'none'; err.style.display = 'none';

      const fd = new FormData(form);
      // Ensure all checked checkboxes are sent as repeated `areas`
      const areas = Array.from(form.querySelectorAll('input[name="areas"]:checked')).map(i => i.value);
      fd.delete('areas'); areas.forEach(v => fd.append('areas', v));

      const body = new URLSearchParams(fd).toString();

      try {
        const resp = await fetch(form.action, {
          method: 'POST',
          headers: { 'Content-Type': 'application/x-www-form-urlencoded;charset=UTF-8' },
          body
        });
        const json = await resp.json().catch(() => ({}));
        if (resp.ok && json.ok) { form.reset(); ok.style.display = 'block'; }
        else { err.style.display = 'block'; }
      } catch { err.style.display = 'block'; }
    });
  </script>
</body></html>
